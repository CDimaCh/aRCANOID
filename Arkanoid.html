<!DOCTYPE html> 
<html>
	<head>
		<meta charset="utf-8" />
		<title>Game</title>
		<script type="text/javascript" language="javascript" src="keys.js"></script>
		<script type="text/javascript" language="javascript" src="engine.js"></script>
		<script type="text/javascript" language="javascript" src="graph.js"></script>
		<script type="text/javascript" language="javascript" src="player.js"></script>
		<script type="text/javascript" language="javascript" src="ball.js"></script>
		<script type="text/javascript" language="javascript" src="grid.js"></script>
	</head>
	<body>
		
		<canvas id="canvas" width="640" height="480" style="position: absolute; top: 0; left: 0;"></canvas>
		<div style="position: absolute; top: 10px; left: 10px;">
			Счет игрока: <b id="score">0</b></br>
			Мячи: <b id="hp">3</b>	
		</div>
		
		<script type="text/javascript">
			init();
			
			var map = {
				color : '#f74141',
				width : 20,
				height : 20,
				offset : 5,
				
				tiles : [
					[0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0],
					[0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0],
					[0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0],
					[1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
					[0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0],
					[0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0],
					[0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0]
				]
			};
			
			grid.create(map);
			
			//grid.generate(5, 60, 40, 'red');
			player.init(width/2, 150, 'blue');
			ball.init(player.x + Math.ceil(player.width / 2), player.y - 5, 5, 'green');
			
			var game = function (){
				
				fillAll('#20bffa');
				
				grid.draw();

				ball.collision();
				ball.move();
				ball.draw();
				
				player.move();
				player.draw();
				
			};
			
			var menu = function (){			
				fillAll('#20bffa');
				grid.draw();
				ball.draw();
				player.draw();
				
				if(isAnyKeyDown()){
					setGame(game);
				}
			};
			
			startGame(menu);
			
		</script>
		
	</body>
</html>